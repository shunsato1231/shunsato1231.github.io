<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">


<title>riot.js＋sass＋gulp で開発する | 8ble.me</title>

<meta name="generator" content="">
<meta name="author" content="">
<meta property="og:locale" content="ja">
<meta property="fb:app_id" content="facebookのAppIDを入れる">
<meta property="og:title" content="riot.js＋sass＋gulp で開発する">
<meta property="og:url" content="http://8ble.me/blog/2016/12/developed-width-riotjs/">
<meta property="og:site_name" content="8ble.me">



<meta name="description" content="最近riot.jsで開発する機会があったので，その時に作った環境について書きます．
...">
<meta property="og:description" content="最近riot.jsで開発する機会があったので，その時に作った環境について書きます．
...">
<meta name="twitter:description" content="最近riot.jsで開発する機会があったので，その時に作った環境について書きます．
...">




<meta property="og:image" content="http://8ble.me/images/ogp.png">
<meta property="twitter:image" content="http://8ble.me/images/ogp.png">



<meta property="og:type" content="article">
<meta property="og:article:published_time" content="2016-12-13T23:26:41&#43;09:00">
<meta property="og:article:tag" content="riot.js" /><meta property="og:article:tag" content="sass" /><meta property="og:article:tag" content="jade" /><meta property="og:article:tag" content="gulp" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@_shun_sato_">
<meta name="twitter:creator" content="@_shun_sato_">
<meta name="twitter:title" content="riot.js＋sass＋gulp で開発する">
<meta name="twitter:url" content="http://8ble.me/blog/2016/12/developed-width-riotjs/">



<link rel="index" href="/"/>





<link rel="prev" href="/blog/2016/12/my-domain/">
<link rel="next" href="/blog/2016/12/twitter-cemetery/">


<link href="http://8ble.me/index.xml" rel="alternate" type="application/rss+xml" title="8ble.me">

    <link href='//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css' media='all' rel='stylesheet'>
    <script src='//code.jquery.com/jquery.js' type='text/javascript'></script>
    <script src='http://8ble.me/js/Chart.min.js' type='text/javascript'></script>
    <script src='http://8ble.me/js/jquery.fittext.js' type='text/javascript'></script>
    <script src='http://8ble.me/js/prism.js' type='text/javascript'></script>
    <script src='http://8ble.me/js/pager.js' type='text/javascript'></script>
    <link href='http://8ble.me/css/style.css' media='all' rel='stylesheet'>
    <link href='http://8ble.me/css/prism.css' media='all' rel='stylesheet'>
    <script src='http://8ble.me/js/script.js' type='text/javascript'></script>
  </head>

  <body>
    <header class='Head'>
  <div class='Head__Wrap'>
    <div class='Head__LoadingBar' id='js-loadingBar'></div>
    <div class='Head__ToTop' id='js-toTop'></div>
    <h1 class='Head__SiteTitle'>
      <a href='http://8ble.me/'><span class='Head__SiteTitle'>8ble.me</span></a>
    </h1>
  </div>
</header>

    <input id='navTgl' type='checkbox'>
<label class='Head__Toggle--Open' for='navTgl'>
  <div class='Head__Toggle__Line'></div>
  <div class='Head__Toggle__Line'></div>
  <div class='Head__Toggle__Line'></div>
</label>
<label class='Head__Toggle--Close' for='navTgl'></label>
<nav class='GlobalNavi'>
  <ul>
    <a href='http://8ble.me/'><li>
      <i class='fa fa-home'></i>
      HOME
    </li></a>
    <a href='http://8ble.me/about'><li>
      <i class='fa fa-male'></i>
      ABOUT
    </li></a>
    <a href='http://8ble.me/blog'><li class='current'>
      <i class='fa fa-book'></i>
      BLOG
    </li></a>
  </ul>
  <div class='GlobalNavi__Profile'>
    <img alt='顔写真' class='GlobalNavi__Profile__Img' height='70' src='http://8ble.me/img/profile.jpg' width='70'>
    <div class='GlobalNavi__Profile__Name'>
      <span class='jp'>佐藤 駿</span>
      <span class='en'>(Shun Sato)</span>
    </div>
    <div class='GlobalNavi__Profile__Txt'>
      平成7年生まれ．高専出身の大学三年生．北海道出身.
    </div>
  </div>
  <div class='GlobalNavi__Icon'>
    <a target='_blank' href='https://twitter.com/_shun_sato_'><i class='twitter'></i></a>
    <a target='_blank' href='https://www.facebook.com/sato.shun.16'><i class='facebook'></i></a>
    <a href=''><i class='mail'></i></a>
  </div>
</nav>


    
    <a class='PrevArticle'  href='/blog/2016/12/my-domain/'>
      <div class='PrevArticle__Txt'>
        独自ドメインを取得しました
      </div>
    </a>
    
   
   <a class='NextArticle' href='/blog/2016/12/twitter-cemetery/'>
     <div class='NextArticle__Txt'>
       Twitter墓地
     </div>
   </a>
   
    <div class='Wrapper'>
      <article class='SingleArticle'>
        <div class='SingleArticle__Meta'>
          <h1 class='SingleArticle__Title'>riot.js＋sass＋gulp で開発する</h1>
          <div class='SingleArticle__Date'>
            2016.12.13
          </div>
          
          <div class='SingleArticle__Category'>
             <a href="/categories/knowledge/">knowledge</a>
          </div>
          

          
          <div class='SingleArticle__Tags'>
             <a href="/tags/riot.js/">riot.js</a> <a href="/tags/sass/">sass</a> <a href="/tags/jade/">jade</a> <a href="/tags/gulp/">gulp</a>
          </div>
          
        </div>
        <div class='SingleArticle__Text'>
          <p>最近riot.jsで開発する機会があったので，その時に作った環境について書きます．
</p>

<hr />

<h2 id="はじめに">はじめに</h2>

<ul>
<li>riot.jsで<code>require</code>を使いたい</li>
<li>cssはsassを使いたい(compassもつかいたい)</li>
<li>テンプレートエンジンはjadeが良い</li>
</ul>

<p>という条件で開発環境構築してみた．
解説詳しくないしメモ程度ですが参考にしてみてください．</p>

<h2 id="フォルダ構成">フォルダ構成</h2>

<pre><code class="language-:none">frontend
   │
   ├ dest
   │  ├ css
   │  │   └ style.css
   │  ├ img
   │  ├ js
   │  ├ index.html
   │  └ main.bundle.js
   │
   ├ src
   │  ├ jade
   │  │　└ index.jade
   │  │
   │  ├ module (riotのタグを置くフォルダ)
   │  ├ scss
   │  │   └ module
   │  ├ js
   │  └ main.js
   │
   ├ gulpfile.js
   ├ config.rb
   └ package.json
</code></pre>

<p>こんな感じのフォルダ構成でいきます．</p>

<p>compassを使おうとするといろいろ面倒くさそうだったので，cssはriotのタグと分離させることにしました．<code>src/module</code>の中にriotのタグを入れて，それに合わせて<code>src/scss/module</code>にスタイルを書いていくことにします．</p>

<h2 id="パッケージのインストール">パッケージのインストール</h2>

<pre><code class="language-json:package.json">{
  ~中略~

  &quot;devDependencies&quot;: {
    &quot;browser-sync&quot;: &quot;^2.17.0&quot;,
    &quot;browserify&quot;: &quot;^13.1.0&quot;,
    &quot;gulp&quot;: &quot;~3.9.1&quot;,
    &quot;gulp-compass&quot;: &quot;~2.0.1&quot;,
    &quot;gulp-convert-encoding&quot;: &quot;^1.0.0&quot;,
    &quot;gulp-jade&quot;: &quot;^1.1.0&quot;,
    &quot;gulp-livereload&quot;: &quot;2.1.1&quot;,
    &quot;gulp-plumber&quot;: &quot;^1.1.0&quot;,
    &quot;gulp-riot&quot;: &quot;^0.5.5&quot;,
    &quot;gulp-watch&quot;: &quot;~1.1.0&quot;,
    &quot;riotify&quot;: &quot;^1.0.1&quot;,
    &quot;vinyl-source-stream&quot;: &quot;^1.1.0&quot;
  }
}
</code></pre>

<p>上記のパッケージをターミナルから<code>sudo npm install (パッケージ名) --dev-save</code>で各々インストール．
(コピぺして <code>npm install</code>でもいいけど，ひとつずつ最新版入れたほうが良いと思います)</p>

<h2 id="設定">設定</h2>

<pre><code class="language-js:gulpfile.js">'use strict';

var gulp            = require('gulp');
var compass         = require('gulp-compass');
var livereload      = require('gulp-livereload');
var browserify      = require('browserify');
var riotify         = require('riotify');
var source          = require('vinyl-source-stream');
var browsersync     = require(&quot;browser-sync&quot;);
var jade            = require('gulp-jade');
var convertEncoding = require('gulp-convert-encoding');
var plumber         = require('gulp-plumber');


/*
 * Compass
 */
 gulp.task('compass', function(){
     gulp.src('./src/scss/**/*.scss')
     .pipe(plumber())
     .pipe(compass({
         config_file: 'config.rb',
         comments: false,
         css: './dest/css',
         sass: './src/scss'
     }))
     .pipe(convertEncoding({to: &quot;utf-8&quot;}))
     .pipe(gulp.dest('./dest/css'))
     .pipe(browsersync.stream());
 });

/*
 * jade
*/
gulp.task('jade', function ()  {
    return gulp.src(['./src/jade/**/*.jade', '!./src/jade/**/_*.jade'])
        .pipe(plumber())
        .pipe(jade({
            pretty: true
        }))
        .pipe(convertEncoding({to: &quot;utf-8&quot;}))
        .pipe(gulp.dest('./dest/'))
        .pipe(browsersync.stream());
});

/*
 * riot
 */
gulp.task('concat', function () {
  return browserify({entries: ['./src/main.js']})
    .transform(riotify, { template: 'jade' })
    .bundle()
    .on('error', function (err) {
      console.log(err.toString());
      this.emit('end');
    })
    .pipe(source('main.bundle.js'))
    .pipe(convertEncoding({to: &quot;utf-8&quot;}))
    .pipe(gulp.dest('./dest/'))
    .pipe(browsersync.stream());
});

/*
 * BrowserSync
 */
gulp.task('server', function () {
 browsersync.init({
   server: {
     baseDir: 'dest'
   },
   open: false,
 });
});


/*
 * Watch
 */
gulp.task('default', ['server'], function() {
  gulp.watch(&quot;./dest/*&quot;, function() {
    browsersync.reload();
  });
  gulp.watch(&quot;./src/**/*.js&quot;, ['concat']);
  gulp.watch(&quot;./src/**/*.tag&quot;, ['concat']);
  gulp.watch(&quot;./src/**/*.scss&quot;, ['compass']);
  gulp.watch(&quot;./src/**/*.jade&quot;, ['jade']);
});

</code></pre>

<pre><code class="language-ruby:config.rb">http_path = &quot;/&quot;
css_dir = &quot;./dest/css&quot;
sass_dir = &quot;./src/scss&quot;
output_style = :nested
line_comments = false
</code></pre>

<p><code>require</code>したいのでriotifyをつかいます．
これで<code>frontend</code>フォルダで<code>gulp</code>コマンドを起動すれば，自動でビルドしてくれます．</p>

<h2 id="使い方">使い方</h2>

<p><code>src/main.js</code>でriotのタグをマウントするスクリプトを記述．</p>

<pre><code class="language-js:main.js">var riot = require('riot');

//include tags
require('./module/tag1');
require('./module/tag1');

//mount
riot.mount('*');
</code></pre>

<p>あとは<code>src/jade/index.jade</code>で<code>main.bundle.js</code>を読み込み．</p>

<pre><code class="language-jade:main.jade">doctype html
html(lang = 'ja')
	head
		meta(charset = 'utf-8')
		link(href = &quot;css/style.css&quot;  media = &quot;all&quot; rel = &quot;stylesheet&quot;)
	body
		tag1
		tag2
	script(src = './main.bundle.js')
</code></pre>

<p>最低限こんな感じでriotのタグをマウントすることができます．</p>

<h3 id="requireをつかう">requireをつかう</h3>

<p><code>src/js</code>フォルダ内にこんなふうにスクリプトを置いて</p>

<pre><code class="language-js:function1.js">module.exports = function(data){
	//なんらかの処理
}
</code></pre>

<p>タグの中で<code>require</code>すれば，自作の関数も<code>main.bandle.js</code>に統合できます．</p>

<pre><code class="language-jade:src/module/tag1.tag">tag1
	#contents
		hogehoge

	script.
		var function1 = require('../js/function1.js');
		function1(data);
</code></pre>

<h2 id="最後に">最後に</h2>

<p>たいしたことなんもやってないけどgulp初めてだったからここまでやるのに時間かかった．</p>
        </div>
        <div class='SingleArticle__Share'>
          <div class='SingleArticle__ShareWrap'>
            <div class='SingleArticle__ShareTitle'>Share on</div>
            <div class='SingleArticle__ShareBlock'>
              <div class='SingleArticle__ShareTwitter'>
                <i class="fa fa-twitter"></i>
                <a href='http://twitter.com/intent/tweet?text=riot.js%ef%bc%8bsass%ef%bc%8bgulp%20%e3%81%a7%e9%96%8b%e7%99%ba%e3%81%99%e3%82%8b%20%7C%208ble.me%20http%3a%2f%2f8ble.me%2fblog%2f2016%2f12%2fdeveloped-width-riotjs%2f%20%40_shun_sato_'>ツイートする</a>
              </div>
              <div class='SingleArticle__ShareFacebook'>
                <i class="fa fa-facebook"></i>
                <a href='https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2f8ble.me%2fblog%2f2016%2f12%2fdeveloped-width-riotjs%2f'>シェアする</a>
              </div>
            </div>
            <div class='SingleArticle__ShareBlock'>
              <div class='SingleArticle__ShareHatebu'>
                <i class="fa fa-hatena"></i>
                <a href='http://b.hatena.ne.jp/entry/add/http://8ble.me/blog/2016/12/developed-width-riotjs/'>はてぶする</a>
              </div>
              <div class='SingleArticle__ShareGoogle'>
                <i class="fa fa-google-plus"></i>
                <a href='https://plus.google.com/share?url=http%3a%2f%2f8ble.me%2fblog%2f2016%2f12%2fdeveloped-width-riotjs%2f'>共有する</a>
              </div>
            </div>
          </div>
        </div>
        <div class='SingleArticle__Breadcrumbs'>
          <ol class='SingleArticle__BreadcrumbsList' typeof='v:Breadcrumb'>
            <i class="fa fa-link"></i>
            <span rel='v:child' typeof='v:Breadcrumb'>
              <a href='http://8ble.me/' property='v:title' rel='v:url'>8ble.net</a>
            </span>
            <span>&frasl;</span>
            <span rel='v:child' typeof='v:Breadcrumb'>
              <a href='http://8ble.me/blog' property='v:title' rel='v:url'>Blog</a>
            </span>
            <span>&frasl;</span>
            <span rel='v:child' typeof='v:Breadcrumb'>
              
               <a href="/categories/knowledge/" property='v:title' rel='v:url'>knowledge</a>
              
            </span>
            <span>&frasl;</span>
            <span rel='v:child' typeof='v:Breadcrumb'>riot.js＋sass＋gulp で開発する</span>
          </ol>
        </div>
      </article>
      <div class='Pager'>
        <a class='Pager__Left', href='http://8ble.me/blog'>
          <i class="fa fa-long-arrow-left"></i>
          BACK TO BLOG
        </a>
      </div>
      <footer class='Footer'>
        <div class='Footer__Wrap'>
          <p class='Footer__Copy'>© 2016 8ble.net All Rights Reserved.</p>
        </div>
      </footer>
    </div>
  </body>
</html>
